#lab3
##练习1：给未被映射的地址映射上物理页（需要编程）
###算法设计
在do_pgfault函数中，在发生缺页异常时，给未被映射的地址分配物理页。

###算法实现
1、调用get_pte获取页表项  
2、若页表项为空，调用pgdir_alloc_page分配物理页  

###请描述页目录项（Page Director Entry）和页表（Page Table Entry）中组成部分对ucore实现页替换算法的潜在用处。
页目录项组成：
>页表地址(20bit)|OS专用(3bit)|0|PSE|0|A|PCD|PWT|U/S|W/R|P

页表项组成：
>物理页帧号(20bit)|OS专用(3bit)|0|D|0|A|PCD|PWT|U/S|W/R|P

其中对页替换算法（如时钟算法）有用处的是：  
A：已访问位。当CPU访问页表项映射的物理页时，页表项的这个标志就会被置为1。ucore可通过该标志来统计页的使用情况。  
 D：修改位。当CPU写页表项映射的物理页内容时，页表项的这个标志就会被置为1。ucore可通过该标志来统计页的修改情况，用于页替换策略，并控制页换出时是否需要写回。  

###如果ucore的缺页服务例程在执行过程中访问内存，出现了页访问异常，请问硬件要做哪些事情？
发生异常后，CPU保存当前被打断的程序现场，关闭中断使能。由于缺页的是服务例程，因此需要CPU把相应的页加载到内存。

##练习2：补充完成基于FIFO的页面替换算法（需要编程）
###算法设计
FIFO算法中，只考虑页的首次访问时间，因此将分配的页按照时间顺序连成链表，当出现缺页置换时，从表首换出一页，然后将新页加入表尾。
###算法实现
1、do_pgfault函数中：把该物理页换入内存，建立虚拟地址和物理地址对应关系，将该页置为可置换  
2、_fifo_map_swappable函数中：将新换入的页加入链表尾  
3、_fifo_swap_out_victim函数中：将链表首的页删除

###如果要在ucore上实现"extended clock页替换算法"请给你的设计方案，现有的swap_manager框架是否足以支持在ucore中实现此算法？
  
extended clock算法中，页面构成环形链表，在出现缺页异常，页面不在内存中时，换入页面，如果此时没有空闲页，则换出一页。

算法关注页面的访问位和修改位，其替换策略如下：  
1、从指针当前位置开始扫描，将找到的第一个A=0,D=0的页换出  
2、如果1失败，找到第一个A=0,D=1进行替换，扫描过程中，将访问位A置为0   
3、如果2失败，回到1

现有的swap_manager框架足够支持在ucore中实现此算法。


##与参考答案的区别
练习1：基本一致。
练习2：FIFO链表方向不同。

##本实验中重要的知识点
###虚拟内存管理
启动分页机制后，通过内存地址虚拟化，可以限定软件的访问空间，并让更多程序并行执行。实验体现了此原理。

###缺页异常
实验中，do_pgfault处理缺页异常。其处理流程与原理课讲述一致。

###页替换算法
实验主要实现了FIFO替换算法，没有用到页表项中为页替换提供的标志位。

##OS原理中很重要，但在实验中没有对应上的知识点
###共享内存
不同进程间存在内存共享，这是进程间通讯的一部分。对共享页的置换处理在实验中没有涉及。

